<nav class="bg-white shadow-md">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="relative flex items-center justify-between h-16">
      <!-- Logo -->
      <div class="flex-shrink-0">
        <%= link_to root_path do %>
          <img src="https://www.zaytoonwpg.com/wp-content/uploads/2021/08/zaytoon_logo-01.png" alt="Zaytoon Logo" class="h-12 w-auto">
        <% end %>
      </div>

      <!-- Menu items and icons -->
      <div class="flex-1 flex items-center justify-end sm:items-stretch sm:justify-end px-4">
        <!-- Centered menu items -->
        <div class="hidden sm:block sm:ml-6">
          <div class="flex space-x-4">
            <%= link_to "Home", root_path, class: "text-gray-900 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
            <%= link_to "Menu", categories_path, class: "text-gray-900 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
            <%= link_to "About Us", about_path, class: "text-gray-900 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
            <%= link_to "Contact", contact_path, class: "text-gray-900 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
          </div>
        </div>
      </div>

      <!-- Search, Cart, and Profile Icons -->
      <div class="flex items-center space-x-2 sm:space-x-4">
        <!-- Search Icon -->
        <div class="relative">
          <button id="search-icon" class="text-gray-900 hover:text-green-600 focus:outline-none">
            <i class="fas fa-search h-5 w-5 sm:h-6 sm:w-6"></i>
          </button>

          <!-- Hidden Search Form -->
          <div id="search-form" class="hidden absolute right-0 mt-2 w-64 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
            <%= form_with url: products_path, method: :get, local: true, class: "px-3 py-2" do %>
              <input type="text" name="search" placeholder="Search..." class="w-full px-3 py-2 border rounded-md">
              <button type="submit" class="hidden"></button>
            <% end %>
          </div>
        </div>

        <!-- Cart Icon -->
        <%= link_to cart_path, class: "text-gray-900 hover:text-green-600 focus:outline-none" do %>
          <i class="fas fa-shopping-cart h-5 w-5 sm:h-6 sm:w-6"></i>
        <% end %>

        <!-- Profile Dropdown -->
        <% if user_signed_in? %>
          <div class="relative">
            <button onclick="toggleDropdown()" class="text-gray-900 hover:text-green-600 focus:outline-none">
              <i class="fas fa-user h-5 w-5 sm:h-6 sm:w-6"></i>
            </button>
            <div id="dropdown-menu" class="hidden origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
              <div class="py-1">
                <%= link_to "Profile", edit_user_registration_path, class: "block px-4 py-2 text-sm sm:text-base text-gray-700 hover:bg-gray-100" %>
                <%= link_to "Orders", past_orders_orders_path, class: "block px-4 py-2 text-sm sm:text-base text-gray-700 hover:bg-gray-100" %>
                <%= link_to "Sign Out", destroy_user_session_path, method: :delete, data: { confirm: "Are you sure?" }, class: "block px-4 py-2 text-sm sm:text-base text-gray-700 hover:bg-gray-100" %>
              </div>
            </div>
          </div>
        <% else %>
          <div class="hidden sm:block">
            <%= link_to "Log In", new_user_session_path, class: "bg-green-500 text-white hover:bg-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
          </div>
        <% end %>
      </div>

      <!-- Mobile menu button -->
      <div class="absolute inset-y-0 right-7 flex items-center sm:hidden px-1">
        <button type="button" class="inline-flex items-center justify-center mx-12 p-2 rounded-md text-gray-400 hover:text-white hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false" onclick="toggleMobileMenu()">
          <span class="sr-only">Open main menu</span>
          <i class="fas fa-bars h-5 w-5 sm:h-6 sm:w-6"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu, show/hide based on menu state. -->
  <div class="sm:hidden hidden" id="mobile-menu">
    <div class="px-4 pt-2 pb-3 space-y-1">
      <%= link_to "Home", root_path, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
      <%= link_to "Menu", categories_path, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
      <%= link_to "About Us", about_path, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
      <%= link_to "Contact", contact_path, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
      <% if user_signed_in? %>
        <%= link_to "Profile", edit_user_registration_path, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
        <%= link_to "Orders", past_orders_orders_path, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
        <%= link_to "Sign Out", destroy_user_session_path, method: :delete, data: { confirm: "Are you sure?" }, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
      <% else %>
        <%= link_to "Log In", new_user_session_path, class: "block text-gray-700 hover:bg-gray-100 hover:text-green-600 px-3 py-2 rounded-md text-base sm:text-lg font-medium" %>
      <% end %>
    </div>
  </div>
</nav>

<script>
  function toggleDropdown() {
    var menu = document.getElementById('dropdown-menu');
    if (menu.classList.contains('hidden')) {
      menu.classList.remove('hidden');
    } else {
      menu.classList.add('hidden');
    }
  }

  function toggleMobileMenu() {
    var mobileMenu = document.getElementById('mobile-menu');
    if (mobileMenu.classList.contains('hidden')) {
      mobileMenu.classList.remove('hidden');
    } else {
      mobileMenu.classList.add('hidden');
    }
  }

  document.getElementById('search-icon').addEventListener('click', function() {
    var searchForm = document.getElementById('search-form');
    if (searchForm.classList.contains('hidden')) {
      searchForm.classList.remove('hidden');
    } else {
      searchForm.classList.add('hidden');
    }
  });
</script>
